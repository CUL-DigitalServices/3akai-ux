<!DOCTYPE HTML>
<html xmlns='http://www.w3.org/1999/xhtml'>
    <head>

        <meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
        <meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1' />

        <!-- CORE CSS -->
        <link rel='stylesheet' type='text/css' href='/ui/css/oae.main.css' />
        <!-- PAGE CSS -->
        <link rel='stylesheet' type='text/css' href='/ui/css/oae.search.css' />

    </head>
    <body class='oae-centered oae-force-hidden'>

        <!-- HEADER -->
        <div class='oae-container-flex header oae-header'>
            <div class='oae-navigation-container'>
                <div data-widget='topnavigation'><!-- --></div>
            </div>
            <div class='oae-fix oae-centered fixed-container oae-fixed-container'>
                <div class='oae-container-shadow-left'><!-- --></div>
                <div class='oae-container-shadow-right'><!-- --></div>
                <div class='oae-page-header'>
                    <!-- SEARCH BAR -->
                    <div class='oae-search' role='search' aria-label='__MSG__SEARCH_FOR__'>
                        <h1 class='oae-bold oae-force-left'>__MSG__SEARCH__</h1>
                        <form id='search_form' class='oae-search-bar'>
                            <input type='text' maxlength='255' id='search_query' title='__MSG__SEARCH_FOR__' class='oae-search-inputfield'/>
                            <button type='submit' class='oae-button oae-overlay-button oae-search-button' title='__MSG__SUBMIT_SEARCH__'>
                                <span class='oae-search-button-icon'></span>
                                <span class='oae-aural-text'>__MSG__SUBMIT_SEARCH__</span>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- BODY -->
        <div class='oae-container-flex'>
            <div class='oae-fix oae-centered fixed-container oae-main-container oae-twocolumn'>
                <div class='oae-page-column-left'>
                    <div data-widget='lhnavigation'><!-- --></div>
                </div>
                <div class='oae-page-column-right'>
                    <div id='oae-page-main-content' class='oae-page-content-padding' role='main'>
                        <div data-widget='contentauthoring'><!-- --></div>
                    </div>
                </div>
                <div class='oae-bottom-spacer'></div>
            </div>
        </div>

        <!-- FOOTER -->
        <div data-widget='footer'><!-- --></div>

        <!-- TEMPLATE CONTAINING THE RESULTS -->
        <div id='search_general_results_template'><!--

            {macro listUser(i, sakai)}
                <li id='${i.id}' class='oae-container oae-fix oae-search-result-person oae-search-result{if i_index === '0'} oae-search-result-first{/if}'>
                    <span class='oae-search-result-user-functions'>
                        {if ! i.isMe && ! sakai.data.me.user.anon}
                            {if ! i.connected}
                                <button title='__MSG__REQUEST_CONNECTION_WITH__ ${i.name|safeOutput}' class='oae-link-button oae-actions-addtolibrary searchpeople_result_left_filler sakai_addtocontacts_overlay' sakai-entityid='${i.userid|safeOutput}' sakai-entityname='${i.name|safeOutput}' {if i.picture}sakai-entitypicture='${i.picture}'{/if}><span class='oae-aural-text'>__MSG__REQUEST_CONNECTION_WITH__ ${i.name|safeOutput}</span></button>
                                <button title='__MSG__SEND_A_MESSAGE_TO__ ${i.name|safeOutput}' class='oae-link-button oae-action-icon oae-actions-message searchpeople_result_message_icon sakai_sendmessage_overlay' sakai-entityid='${i.userid|safeOutput}' sakai-entityname='${i.name|safeOutput}' sakai-entitytype='user'><span class='oae-aural-text'>__MSG__SEND_A_MESSAGE_TO__ ${i.name|safeOutput}</span></button>
                            {elseif i.invited}
                                <button title='__MSG__ACCEPT_CONNECTION_WITH__ ${i.name|safeOutput}' class='oae-link-button oae-actions-addtolibrary searchpeople_result_left_filler link_accept_invitation' sakai-entityid='${i.userid|safeOutput}' sakai-entityname='${i.name|safeOutput}' {if i.picture}sakai-entitypicture='${i.picture}'{/if}><span class='oae-aural-text'>__MSG__ACCEPT_CONNECTION_WITH__ ${i.name|safeOutput}</span></button>
                                <button title='__MSG__SEND_A_MESSAGE_TO__ ${i.name|safeOutput}' class='oae-link-button oae-action-icon oae-actions-message searchpeople_result_message_icon sakai_sendmessage_overlay' sakai-entityid='${i.userid|safeOutput}' sakai-entityname='${i.name|safeOutput}' sakai-entitytype='user'><span class='oae-aural-text'>__MSG__SEND_A_MESSAGE_TO__ ${i.name|safeOutput}</span></button>
                                <div class='searchpeople_result_left_filler' id='search_result_contact_${i.userid|safeOutput}' style='display:none;'><img src='/dev/images/accept.png' alt='__MSG__USER_IS_A_CONTACT__' /></div>
                            {elseif i.pending}
                                <div class='searchpeople_result_left_filler'></div>
                                <button title='__MSG__SEND_A_MESSAGE_TO__ ${i.name|safeOutput}' class='oae-link-button oae-action-icon oae-actions-message searchpeople_result_message_icon sakai_sendmessage_overlay' sakai-entityid='${i.userid|safeOutput}' sakai-entityname='${i.name|safeOutput}' sakai-entitytype='user'><span class='oae-aural-text'>__MSG__SEND_A_MESSAGE_TO__ ${i.name|safeOutput}</span></button>
                            {else}
                                <div class='searchpeople_result_left_filler'><img src='/dev/images/accept.png' alt='__MSG__USER_IS_A_CONTACT__' /></div>
                                <button title='__MSG__SEND_A_MESSAGE_TO__ ${i.name|safeOutput}' class='oae-link-button oae-action-icon oae-actions-message searchpeople_result_message_icon sakai_sendmessage_overlay' sakai-entityid='${i.userid|safeOutput}' sakai-entityname='${i.name|safeOutput}' sakai-entitytype='user'><span class='oae-aural-text'>__MSG__SEND_A_MESSAGE_TO__ ${i.name|safeOutput}</span></button>
                            {/if}
                        {else}
                            <div class='searchpeople_result_left_filler'></div>
                        {/if}
                    </span>
                    <span class='oae-search-result-anonuser'></span>
                    {if ! i.picture}
                        <a href='/~${i.userid|safeURL}' class='oae-icon searchpeople_result_person_picture' title='__MSG__VIEW_PERSONS_PROFILE__'></a>
                    {else}
                        <a href='/~${i.userid|safeURL}' class='searchpeople_result_person_picture' title='__MSG__VIEW_PERSONS_PROFILE__'>
                            <img alt='__MSG__VIEW_PERSONS_PROFILE__' src='${i.picture}'/>
                            {if i.pictureLarge}
                                <img alt='__MSG__VIEW_PERSONS_PROFILE__' src='${i.pictureLarge}' class='oae-search-result-avatar-large'/>
                            {/if}
                        </a>
                    {/if}
                    <div class='oae-search-result-right'>
                        <a href='/~${i.userid|safeURL}' class='oae-bold oae-regular-light-links' title='${i.name}'>
                            <span class='oae-search-result-name'>${i.nameShort}</span>
                            <span class='oae-search-result-name-grid'>${i.nameShorter}</span>
                        </a>
                        <div class='searchpeople_result_counts'>
                            {if i.counts.contentCount > 0}
                                <a class='oae-regular-light-links' href='/~${i.userid|safeURL}#l=library'>
                                    <span class='oae-search-result-name oae-aural-text'>${i.nameShort} __MSG__HAS__ </span>
                                    <span class='oae-search-result-name-grid oae-aural-text'>${i.nameShorter} __MSG__HAS__ </span>
                                    ${i.counts.contentCount || 0} {if i.counts.contentCount === 1} __MSG__CONTENT_ITEM__{else} __MSG__CONTENT_ITEMS__{/if}
                                </a>
                                {if i.counts.contactsCount > 0 || i.counts.membershipsCount > 0}
                                    <span class='oae-search-result-detail-separator'><span> | </span></span>
                                {/if}
                            {/if}
                            {if i.counts.contactsCount > 0}
                                <a class='oae-regular-light-links' href='/~${i.userid|safeURL}#l=contacts'>
                                    <span class='oae-search-result-name oae-aural-text'>${i.nameShort} __MSG__HAS__ </span>
                                    <span class='oae-search-result-name-grid oae-aural-text'>${i.nameShorter} __MSG__HAS__ </span>
                                    ${i.counts.contactsCount || 0} {if i.counts.contactsCount === 1} __MSG__CONTACT_LC__{else} __MSG__CONTACTS_LC__{/if}
                                </a>
                                {if i.counts.membershipsCount > 0}
                                    <span class='oae-search-result-detail-separator'><span> | </span></span>
                                {/if}
                            {/if}
                            {if i.counts.membershipsCount > 0}
                                <a class='oae-regular-light-links' href='/~${i.userid|safeURL}#l=memberships'>
                                    <span class='oae-search-result-name oae-aural-text'>${i.nameShort} __MSG__HAS__ </span>
                                    <span class='oae-search-result-name-grid oae-aural-text'>${i.nameShorter} __MSG__HAS__ </span>
                                    ${i.counts.membershipsCount || 0} {if i.counts.membershipsCount === 1} __MSG__MEMBERSHIP_LC__{else} __MSG__MEMBERSHIPS_LC__{/if}
                                </a>
                            {/if}
                        </div>
                        {if !$.isEmptyObject(i.tagsProcessed)}
                            ${macro('search.tags', i.tagsProcessed, i.name)}
                        {/if}
                    </div>
                </li>
            {/macro}

            {macro listGroup(i, sakai)}
                <li id='${i.id}' class='oae-container oae-fix searchgroups_result oae-search-result-group oae-search-result{if i_index === '0'} oae-search-result-first{/if}'>
                    <span class='oae-search-result-user-functions'>
                        <div class='{if !i.userMember && i['sakai:group-joinable'] !== 'no'} oae-action-icon oae-actions-addtolibrary searchgroups_result_plus {/if} searchgroups_result_left_filler' data-group-joinable='${i['sakai:group-joinable']}' data-groupid='${i['sakai:group-id']}'><img src='/dev/images/accept.png' alt='' class='searchgroups_memberimage_${i['sakai:group-id']}' {if !i.userMember}style='display:none;' {/if}>{if !i.userMember && i['sakai:group-joinable'] !== 'no'}<span class='oae-aural-text'>__MSG__JOIN__ ${i['sakai:group-title']|safeOutput}</span>{/if}</div>
                        <button title='__MSG__SEND_A_MESSAGE_TO__ ${i['sakai:group-title']|safeOutput}' class='oae-link-button searchgroups_result_message_icon oae-action-icon oae-actions-message sakai_sendmessage_overlay' sakai-entityid='${i['sakai:group-id']|safeOutput}' sakai-entityname='${i['sakai:group-title']|safeOutput}' sakai-entitytype='group'><span class='oae-aural-text'>__MSG__SEND_A_MESSAGE_TO__ ${i['sakai:group-title']|safeOutput}</span></button>
                    </span>
                    <span class='oae-search-result-anonuser'></span>
                    <a href='${i.homePath}' title='${i['sakai:group-title']|safeOutput}'>
                        <img src='${sakai.api.Groups.getProfilePicture(i)}' alt='${i['sakai:group-title']|safeOutput}'>
                        {if i.picPathLarge}
                            <img src='${i.picPathLarge}' alt='${i['sakai:group-title']|safeOutput}' class='oae-search-result-avatar-large'>
                        {/if}
                    </a>
                    <div class='oae-search-result-right'>
                        <div>
                            <a class='oae-bold oae-regular-light-links' href='${i.homePath}' title='${i['sakai:group-title']|safeOutput}'>
                                <span class='oae-search-result-name'>${i['sakai:group-title-short']}</span>
                                <span class='oae-search-result-name-grid'>${i['sakai:group-title-shorter']}</span>
                            </a>
                            {if i.groupType}
                                <span class='searchgroups_result_grouptype'>${i.groupType.toUpperCase()}</span>
                            {/if}
                        </div>
                        <div class='searchgroups_result_usedin'>
                            __MSG__CHANGED__ ${jQuery.timeago(new Date(i.lastModified))}
                            {var contentItemCount = i.counts.contentCount}
                            {if contentItemCount > 0}
                                <span class='oae-search-result-detail-separator'><span> | </span></span>
                                <a class='oae-regular-light-links' href='${i.homePath}#l=library'>${contentItemCount} {if contentItemCount === 1} __MSG__CONTENT_ITEM__{else} __MSG__CONTENT_ITEMS__{/if}</a>
                            {/if}
                            {var participantCount = i.counts.membersCount}
                            {if participantCount > 0}
                                <span class='oae-search-result-detail-separator'><span> | </span></span>
                                <a class='oae-regular-light-links' href='${i.homePath}#l=participants'>
                                    <span class='oae-aural-text'>${i['sakai:group-title']|safeOutput} __MSG__HAS__ </span><span id='searchgroups_result_participant_count_${i['sakai:group-id']|safeOutput}'>${participantCount}</span> <span id='searchgroups_text_participant_${i['sakai:group-id']|safeOutput}'>{if participantCount === 1}__MSG__PARTICIPANT_LC__{else}__MSG__PARTICIPANTS_LC__{/if}</span>
                                </a>
                            {/if}
                        </div>
                        {if i['sakai:group-description-short']}
                            <div class='searchgroups_result_description'>${i['sakai:group-description-short']}</div>
                            <div class='searchgroups_result_description_grid'>${i['sakai:group-description-shorter']}</div>
                        {/if}
                        {if !$.isEmptyObject(i.tagsProcessed)}
                            ${macro('search.tags', i.tagsProcessed, sakai.api.Util.Security.safeOutput(i['sakai:group-title']))}
                        {/if}
                    </div>
                </li>
            {/macro}

            {for i in items}
                {if i['sakai:pooled-content-file-name']}
                    ${macro('search.listContent',i, sakai, i_index)}
                {elseif i.userid}
                    ${listUser(i, sakai)}
                {elseif i['sakai:group-id']}
                    ${listGroup(i, sakai)}
                {/if}
            {/for}

        --></div>

        <!-- DEPENDENCIES -->
        <script data-main='/shared/oae/api/oae.bootstrap.js' src='/shared/vendor/js/require.js'></script>
        <!-- PAGE JS -->
        <script>require(['/ui/js/search.js']);</script>

    </body>
</html>
